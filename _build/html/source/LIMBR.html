

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>LIMBR package &mdash; LIMBR v0.2.6-alpha documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="LIMBR v0.2.6-alpha documentation" href="../index.html"/>
        <link rel="up" title="LIMBR" href="modules.html"/>
        <link rel="prev" title="LIMBR" href="modules.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LIMBR
          

          
          </a>

          
            
            
              <div class="version">
                0.2.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">LIMBR</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">LIMBR package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-LIMBR.imputable">LIMBR.imputable module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-LIMBR.old_fashioned">LIMBR.old_fashioned module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-LIMBR.sva">LIMBR.sva module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-LIMBR">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LIMBR</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">LIMBR</a> &raquo;</li>
        
      <li>LIMBR package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/source/LIMBR.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="limbr-package">
<h1>LIMBR package<a class="headerlink" href="#limbr-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-LIMBR.imputable">
<span id="limbr-imputable-module"></span><h2>LIMBR.imputable module<a class="headerlink" href="#module-LIMBR.imputable" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="LIMBR.imputable.imputable">
<em class="property">class </em><code class="descclassname">LIMBR.imputable.</code><code class="descname">imputable</code><span class="sig-paren">(</span><em>filename</em>, <em>missingness</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/imputable.html#imputable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.imputable.imputable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Imputes missing data with K Nearest Neighbors based on user specified parameters.</p>
<p>This class generates an object from raw data and allows for preprocessing, imputation and output of that data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – This is the path to the file containing the raw data.</li>
<li><strong>missingness</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – This is the maximum allowable percentage of missingness expressed as a decimal.  For example a value of 0.25 would mean that all rows for which more than one in four values are missing will be rejected.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>dataframe</em>) – This is where the raw data read from filename is stored.</li>
<li><strong>miss</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – This is where the maximum allowable percentage of missingness expressed as a decimal is stored.</li>
<li><strong>pats</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – This is where the set of missingness patterns found in the dataset will be stored later, initialized here.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="LIMBR.imputable.imputable.deduplicate">
<code class="descname">deduplicate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/imputable.html#imputable.deduplicate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.imputable.imputable.deduplicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes duplicate peptides.</p>
<p>Groups rows by peptide, if a peptide appears in more than one row it is removed.</p>
</dd></dl>

<dl class="method">
<dt id="LIMBR.imputable.imputable.drop_missing">
<code class="descname">drop_missing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/imputable.html#imputable.drop_missing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.imputable.imputable.drop_missing" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes rows which are missing more data than the user specified missingness threshold.</p>
</dd></dl>

<dl class="method">
<dt id="LIMBR.imputable.imputable.impute">
<code class="descname">impute</code><span class="sig-paren">(</span><em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/imputable.html#imputable.impute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.imputable.imputable.impute" title="Permalink to this definition">¶</a></dt>
<dd><p>Imputes missing data with KNN and outputs the results to the specified file.</p>
<p>First all of the missingness patterns present in the dataset are identified.  Then those patterns are iterated over and for each pattern, missing values are imputed.  Finally the dataset is reformed with the imputed values and output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>outname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to output file.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-LIMBR.old_fashioned">
<span id="limbr-old-fashioned-module"></span><h2>LIMBR.old_fashioned module<a class="headerlink" href="#module-LIMBR.old_fashioned" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="LIMBR.old_fashioned.old_fashioned">
<em class="property">class </em><code class="descclassname">LIMBR.old_fashioned.</code><code class="descname">old_fashioned</code><span class="sig-paren">(</span><em>filename</em>, <em>data_type</em>, <em>pool=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/old_fashioned.html#old_fashioned"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.old_fashioned.old_fashioned" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Performs a standard normalization procedure without SVD as a baseline.</p>
<p>This class performs simple quantile normalization and row scaling along with pool normalization for proteomics experiments using the same methods and interface employed in the sva class.  This provides a baseline comparison point for data processed with LIMBR.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to the input dataset.</li>
<li><strong>data_type</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Type of dataset, one of ‘p’ or ‘r’.  ‘p’ indicates proteomic with two index columns specifying peptide and protein.  ‘r’ indicates RNAseq with one index column indicating gene.</li>
<li><strong>pool</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to file containing pooled control design for experiment in the case of data_type = ‘p’.  This should be a pickled dictionary with the keys being column headers corresponding to each sample and the values being the corresponding pooled control number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>raw_data</strong> (<em>dataframe</em>) – This is where the input data is stored.</li>
<li><strong>data_type</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – This is where the data type (‘p’ or ‘r’) is stored.</li>
<li><strong>norm_map</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – This is where the assignment of pooled controls to samples are stored if data_type = ‘p’.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="LIMBR.old_fashioned.old_fashioned.normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/old_fashioned.html#old_fashioned.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.old_fashioned.old_fashioned.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Groups peptides by protein and outputs final processed dataset.</p>
<p>These final results are then written to an output file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>outname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to desired output file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.old_fashioned.old_fashioned.pool_normalize">
<code class="descname">pool_normalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/old_fashioned.html#old_fashioned.pool_normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.old_fashioned.old_fashioned.pool_normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocessing normalization.</p>
<p>Performs pool normalization on an sva object using the raw_data and norm_map if pooled controls were used. Quantile normalization of each column and scaling of each row are then performed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>scaler</strong> (<em>sklearn.preprocessing.StandardScaler</em><em>(</em><em>)</em>) – A fitted scaler from the sklearn preprocessing module.</li>
<li><strong>data_pnorm</strong> (<em>dataframe</em>) – Pool normalized data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-LIMBR.sva">
<span id="limbr-sva-module"></span><h2>LIMBR.sva module<a class="headerlink" href="#module-LIMBR.sva" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="LIMBR.sva.sva">
<em class="property">class </em><code class="descclassname">LIMBR.sva.</code><code class="descname">sva</code><span class="sig-paren">(</span><em>filename</em>, <em>design</em>, <em>data_type</em>, <em>blocks=None</em>, <em>pool=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Performs sva based identification and remmoval of batch effects.</p>
<p>This class takes a dataset without missing values (raw RNAseq or Proteomics from class imputable).  It performs pool normalization for proteomics datasets and quantile normalization and scaling for all datasets.  The data is then subsetted based on correlation to a primary variable of interest determined by the experimental design.  This subsetted data is used to calculate a residual matrix from which initial estimates of batch effects are produced by SVD.  Significance of these batch effects are estimated by permutation of the residual matrix.  Batch effects deemed significant are regressed against the original dataset and final batch effects are calculated from those rows most correlated with the effect.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to the input dataset.</li>
<li><strong>design</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Experimental design, one of: ‘c’, ‘l’, ‘b’.  ‘c’ indicates a circadian timecourse. ‘l’ indicates a general timecourse (lowess fit used).  ‘b’ indicates a block design.</li>
<li><strong>data_type</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Type of dataset, one of ‘p’ or ‘r’.  ‘p’ indicates proteomic with two index columns specifying peptide and protein.  ‘r’ indicates RNAseq with one index column indicating gene.</li>
<li><strong>blocks</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to file containing block design in the case of design = ‘b’.  This should be a pickled list of which block each sample corresponds with.</li>
<li><strong>pool</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to file containing pooled control design for experiment in the case of data_type = ‘p’.  This should be a pickled dictionary with the keys being column headers corresponding to each sample and the values being the corresponding pooled control number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>raw_data</strong> (<em>dataframe</em>) – This is where the input data is stored.</li>
<li><strong>data_type</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – This is where the data type (‘p’ or ‘r’) is stored.</li>
<li><strong>designtype</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – This is where the design type of the experiment (‘c’,’l’ or ‘b’) is stored.</li>
<li><strong>block_design</strong> (<em>list</em>) – This is where the block assignments for each sample are stored if designtype = ‘b’.</li>
<li><strong>norm_map</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – This is where the assignment of pooled controls to samples are stored if data_type = ‘p’.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="LIMBR.sva.sva.eig_reg">
<code class="descname">eig_reg</code><span class="sig-paren">(</span><em>alpha</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.eig_reg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.eig_reg" title="Permalink to this definition">¶</a></dt>
<dd><p>Regresses eigentrends (batch effects) against the reduced dataset calculating p values for each row being associated with that trend.</p>
<p>Batch effects are estimated with SVD and only those passing the significance threshold for permutation testing are retained.  These trends are then regressed against each row of the reduced data to estimate a p value for that row’s association with that trend.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Significance threshold for permutation testing, expressed as a decimal.</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><strong>ps</strong> (<em>arr</em>) – P values for association between rows and estimated batch effects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.get_res">
<code class="descname">get_res</code><span class="sig-paren">(</span><em>in_arr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.get_res"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.get_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates model residuals from which to learn batch effects.</p>
<p>For time course based designs, this is done with a lowess model.  For block designs, this is done with the block means.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>in_arr</strong> (<em>arr</em>) – Input array of data from which to calculate residuals.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>res_mat</strong> – Residual matrix.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">arr</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.get_tks">
<code class="descname">get_tks</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.get_tks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.get_tks" title="Permalink to this definition">¶</a></dt>
<dd><p>calculates the fraction of variance for each row of the residual matrix explained by each principle component with PCA</p>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.get_tpoints">
<code class="descname">get_tpoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.get_tpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.get_tpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts timepoints from header of data.</p>
<p>Splits strings in header based on required syntax and generates timepoints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>tpoints</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – array of timepoints at which samples were collected.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates diagnostic files, normalizes data based on calculated batch effects, groups peptides by protein and outputs final processed dataset.</p>
<p>Diagnostic files containing estimated batch effects, explained variance ratios, results of permutation testing and estimated magnitudes of each batch effect on each peptide are generated.  The signal produced by significant batch effects is then estimated and removed from the dataset.  These final results are then written to an output file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>outname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to desired output file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><strong>svd_norm</strong> (<em>dataframe</em>) – Normalized dataframe with significant batch effects removed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.perm_test">
<code class="descname">perm_test</code><span class="sig-paren">(</span><em>nperm</em>, <em>npr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.perm_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.perm_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs permutation testing on residual matrix SVD.</p>
<p>The rows of the residual matrix are first permuted.  Then  get_tks is called to calculate explained variance ratios and these tks are compared to the values from the actual residual matrix.  A running total is kept for the number of times the explained variance from the permuted matrix exceeds that from the original matrix. And significance is estimated by dividing these totals by the number of permutations.  This permutation testing is multiprocessed to decrease calculation times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nperm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of permutations to be tested.</li>
<li><strong>npr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of processors to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><p class="first last"><strong>sigs</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Estimated significances for each batch effect.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.pool_normalize">
<code class="descname">pool_normalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.pool_normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.pool_normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocessing normalization.</p>
<p>Performs pool normalization on an sva object using the raw_data and norm_map if pooled controls were used. Quantile normalization of each column and scaling of each row are then performed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>scaler</strong> (<em>sklearn.preprocessing.StandardScaler</em><em>(</em><em>)</em>) – A fitted scaler from the sklearn preprocessing module.</li>
<li><strong>data_pnorm</strong> (<em>dataframe</em>) – Pool normalized data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.prim_cor">
<code class="descname">prim_cor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.prim_cor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.prim_cor" title="Permalink to this definition">¶</a></dt>
<dd><p>calculates correlation for each row against the primary variable of interest.</p>
<p>The primary variable of interest is defined based on the designtype.  For circadian (‘c’) this is the difference between the autocorrelation at the expected period and one half that period.  For general timecourse (‘l’) this is the goodness of fit of a lowess model.  For a block design (‘b’) this is the ANOVA f statistic.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>cors</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Array of correlations with primary variable of interest.  The calculation of this variable is determined by the designtype as specified above and the procedure described in the corresponding function.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.reduce">
<code class="descname">reduce</code><span class="sig-paren">(</span><em>percsub</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the data based on the correlation to primary variable of interest calculated in prim_cor.</p>
<p>Rows most correlated with the variable of interest up to the specified percentage are dropped from the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>percsub</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Percentage of data to remove during reduction.</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><strong>data_reduced</strong> (<em>dataframe</em>) – Reduced dataset.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.set_res">
<code class="descname">set_res</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.set_res"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.set_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls get_res()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>res</strong> (<em>arr</em>) – This is where the residual matrix is stored.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.set_tks">
<code class="descname">set_tks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.set_tks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.set_tks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls get_tks().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>tks</strong> (<em>list</em>) – This is where the tks (explained variance ratios) are stored.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="LIMBR.sva.sva.subset_svd">
<code class="descname">subset_svd</code><span class="sig-paren">(</span><em>lam</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/LIMBR/sva.html#sva.subset_svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#LIMBR.sva.sva.subset_svd" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs SVD on the subset of rows associated with each batch effect.</p>
<p>The reduced data is first subsetted based on the p values form the regression for each estimated batch effect.  After subsetting the reduced data, SVD is performed on this matrix and the true batch effect is taken as the right singular vector most correlated with the initially estimated batch effect.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lam</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – P value cutoff above which distribution is assumed to be uniform.  Used to calculate significance cutoff.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>ts</strong> (<em>arr</em>) – Estimated batch effects (right singular vectors).</li>
<li><strong>pepts</strong> (<em>arr</em>) – Estimates of effect size for each batch effect on each peptide (left singular vectors).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-LIMBR">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-LIMBR" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="modules.html" class="btn btn-neutral" title="LIMBR" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Alexander Crowell.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v0.2.6-alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>