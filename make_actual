FILES += output/actual/imputed_peptide.txt output/actual/csp_for_sva.txt output/actual/wt_for_sva.txt

FILES += output/actual/wt_lowess_normed.txt output/actual/csp_lowess_normed.txt output/actual/rna_lowess_normed.txt

FILES += output/actual/wt_lowess_normed.txt output/actual/csp_lowess_normed.txt output/actual/rna_lowess_normed.txt

FILES += output/actual/wt_lowess_normed__jtkout_GammaP.txt output/actual/csp_lowess_normed__jtkout_GammaP.txt output/actual/rna_lowess_normed__jtkout_GammaP.txt

all: ${FILES}

data/Formatted_input.txt data/Jen_rnaseq_formatted_raw_counts.txt :

output/actual/imputed_peptide.txt : data/Formatted_input.txt
	@echo Imputing
	@head -n 100 data/Formatted_input.txt > temp.txt
	@python3 src/knn_impute.py -i temp.txt -o $@ -m 0.3 -p 2

output/actual/csp_for_sva.txt output/actual/wt_for_sva.txt output/actual/rna_for_sva.txt : data/Jen_rnaseq_formatted_raw_counts.txt output/actual/imputed_peptide.txt
	@echo pool normalizing
	@python3 src/pool_norm_and_seperate.py

output/actual/wt_lowess_normed.txt : output/actual/wt_for_sva.txt
	@echo Lowess normalizing $<
	@python3 src/sva_normalize.py -i $< -o $@ -s 25 -n 8 -p 100 -a .05 -d c -e p

output/actual/csp_lowess_normed.txt : output/actual/csp_for_sva.txt
	@echo Lowess normalizing $<
	@python3 src/sva_normalize.py -i $< -o $@ -s 25 -n 8 -p 100 -a .05 -d c -e p

output/actual/rna_lowess_normed.txt : output/actual/rna_for_sva.txt
	@echo Lowess normalizing $<
	@python3 src/sva_normalize.py -i $< -o $@ -s 25 -n 8 -p 100 -a .05 -d c -e r

output/actual/%__jtkout_GammaP.txt: output/actual/%.txt
	@echo Running eJTK on $<
	@sed -e 's/_[[:digit:]]//g' $< > temp.txt
	@mv temp.txt $<
	@python3 src/eJTK-CalcP.py -f $< -w src/ref_files/waveform_cosine.txt -a src/ref_files/asymmetries_02-22_by2.txt -s src/ref_files/phases_00-22_by2.txt -p src/ref_files/period24.txt
	@rm output/actual/*__jtknull1000.txt
	@rm output/actual/*__jtkout.txt