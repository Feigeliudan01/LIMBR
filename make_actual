FILES += output/actual/imputed_peptide.txt output/actual/csp_for_sva.txt output/actual/wt_for_sva.txt

FILES += output/actual/wt_lowess_normed.txt output/actual/csp_lowess_normed.txt output/actual/rna_lowess_normed.txt

FILES += output/actual/wt_lowess_normed__jtkout_GammaP.txt output/actual/csp_lowess_normed__jtkout_GammaP.txt output/actual/rna_lowess_normed__jtkout_GammaP.txt

FILES += output/actual/wt_old_normed.txt output/actual/csp_old_normed.txt output/actual/rna_old_normed.txt

FILES += output/actual/wt_old_normed__jtkout_GammaP.txt output/actual/csp_old_normed__jtkout_GammaP.txt output/actual/rna_old_normed__jtkout_GammaP.txt


all: ${FILES}

data/Formatted_input.txt data/Jen_rnaseq_formatted_raw_counts.txt :

output/actual/imputed_peptide.txt : data/Formatted_input.txt
	@echo Imputing
	@head -n 100 data/Formatted_input.txt > temp.txt
	@python3 src/knn_impute.py -i temp.txt -o $@ -m 0.3 -p 2

output/actual/csp_for_sva.txt output/actual/wt_for_sva.txt output/actual/rna_for_sva.txt : data/Jen_rnaseq_formatted_raw_counts.txt output/actual/imputed_peptide.txt
	@echo pool normalizing
	@python3 src/separate.py

output/actual/wt_lowess_normed.txt : output/actual/wt_for_sva.txt
	@echo Lowess normalizing $<
	@python3 src/sva_normalize.py -i $< -o $@ -s 25 -n 12 -p 1000 -a .05 -d c -e p -j output/actual/wt_pool_design.p

output/actual/csp_lowess_normed.txt : output/actual/csp_for_sva.txt
	@echo Lowess normalizing $<
	@python3 src/sva_normalize.py -i $< -o $@ -s 25 -n 12 -p 1000 -a .05 -d c -e p -j output/actual/csp_pool_design.p

output/actual/rna_lowess_normed.txt : output/actual/rna_for_sva.txt
	@echo Lowess normalizing $<
	@python3 src/sva_normalize.py -i $< -o $@ -s 25 -n 12 -p 1000 -a .05 -d c -e r

output/actual/wt_old_normed.txt : output/actual/wt_for_sva.txt
	@echo old fashioned normalizing $<
	@python3 src/old_normalize.py -i $< -o $@ -e p -pp output/actual/wt_pool_design.p

output/actual/csp_old_normed.txt : output/actual/csp_for_sva.txt
	@echo old fashioned normalizing $<
	@python3 src/old_normalize.py -i $< -o $@ -e p -pp output/actual/csp_pool_design.p

output/actual/rna_old_normed.txt : output/actual/rna_for_sva.txt
	@echo old fashioned normalizing $<
	@python3 src/old_normalize.py -i $< -o $@ -e r

output/actual/wt_lowess_normed__jtkout_GammaP.txt output/actual/csp_lowess_normed__jtkout_GammaP.txt output/actual/wt_old_normed__jtkout_GammaP.txt output/actual/csp_old_normed__jtkout_GammaP.txt: output/actual/wt_lowess_normed.txt output/actual/csp_lowess_normed.txt output/actual/wt_old_normed.txt output/actual/csp_old_normed.txt
	@echo Running eJTK on $<
	@sed -e 's/_[[:digit:]]//g' $< > temp.txt
	@cut -f 1,5- temp.txt > $<
	@python src/eJTK-CalcP.py -f $< -w src/ref_files/waveform_cosine.txt -a src/ref_files/asymmetries_02-22_by2.txt -s src/ref_files/phases_00-22_by2.txt -p src/ref_files/period24.txt
	@rm output/actual/*__jtknull1000.txt
	@rm output/actual/*__jtkout.txt

output/actual/rna_lowess_normed__jtkout_GammaP.txt output/actual/rna_old_normed__jtkout_GammaP.txt: output/actual/rna_old_normed.txt
	@echo Running eJTK on $<
	@sed -e 's/_[[:digit:]]//g' $< > temp.txt
	@mv temp.txt $<
	@python src/eJTK-CalcP.py -f $< -w src/ref_files/waveform_cosine.txt -a src/ref_files/asymmetries_02-22_by2.txt -s src/ref_files/phases_00-22_by2.txt -p src/ref_files/period24.txt
	@rm output/actual/*__jtknull1000.txt
	@rm output/actual/*__jtkout.txt
